{% extends 'base.html' %} {% block content %}
<div class="chat-container">
  <h2>Conversa {{ conversation.pk }}</h2>
  <div id="messages" class="messages">
    {% for m in messages %}
    <div class="message {% if m.sender == user %}mine{% endif %}">
      <div class="meta">{{ m.sender.username }} â€” {{ m.created_at }}</div>
      <div class="content">{{ m.content }}</div>
    </div>
    {% endfor %}
  </div>

  <form
    id="sendForm"
    method="post"
    action="{% url 'mensagens:api_send' conversation.pk %}"
  >
    {% csrf_token %}
    <textarea
      name="content"
      id="msgContent"
      placeholder="Escreva sua mensagem..."
    ></textarea>
    <button id="sendBtn" type="submit">Enviar</button>
  </form>
</div>

<script src="/static/js/chat.js"></script>
<script>
  window.CONVERSATION_ID = {{ conversation.pk }};
  window.USER_ID = {{ user.pk|default:'null' }};
</script>
{% endblock %}
